var ClipperPrefix="ON",ClipperRootUrl="https://www.onenote.com/Clipper/Root?NoAuth=1",ClipperIdPropertyName="clipperId",ChromeStorage=chrome.storage.local;ChromeStorage.get(ClipperIdPropertyName,GetOrCreateClipperId);function GetOrCreateClipperId(b){var a;if(b&&b[ClipperIdPropertyName])a=b[ClipperIdPropertyName];else{a=GenerateClipperId();ChromeStorage.set({clipperId:a});chrome.tabs.getSelected(null,function(a){!IsOnOneNoteDomain(a.url)&&chrome.tabs.create({url:"https://www.onenote.com/Clipper/OneNote"})})}RegisterBrowserAction(a)}function IsOnOneNoteDomain(a){return a.indexOf("onenote.com")>=0||a.indexOf("onenote-int.com")>=0}function RegisterBrowserAction(a){var b="javascript:(function(){if(typeof OneNoteBookmarklet === 'undefined'){var jsCode=document.createElement('script');jsCode.setAttribute('src', '"+ClipperRootUrl+"');jsCode.setAttribute('id','oneNoteCaptureRootScript');jsCode.setAttribute('clipperId','"+a+"');jsCode.setAttribute('type', 'text/javascript');document.body.appendChild(jsCode);}})()";chrome.browserAction.onClicked.addListener(function(){chrome.tabs.executeScript(null,{code:b})})}function GenerateClipperId(){return ClipperPrefix+"-"+GenerateGuid()}function GenerateGuid(){return GenerateFourCharGuid()+GenerateFourCharGuid()+"-"+GenerateFourCharGuid()+"-"+GenerateFourCharGuid()+"-"+GenerateFourCharGuid()+"-"+GenerateFourCharGuid()+GenerateFourCharGuid()+GenerateFourCharGuid()}function GenerateFourCharGuid(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)};