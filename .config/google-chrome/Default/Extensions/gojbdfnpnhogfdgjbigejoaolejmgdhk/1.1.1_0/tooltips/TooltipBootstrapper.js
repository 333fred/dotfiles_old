var tooltipIframeId="oneNoteClipperTooltipIframe";console.log("tooltipBootstrapper.ts: document Url: "+document.URL);var SendMessageToExtension=function(b,a){chrome.runtime.sendMessage(b,function(b){a(b)})},CreateIframeTooltip=function(c,b){var a=document.createElement("iframe");a.id=tooltipIframeId;a.className="oneNoteClipperTooltip";a.src=c;$(a).hide();a.addEventListener("load",function(){$.ajax({url:b,cache:false,success:function(){$("<link/>",{rel:"stylesheet",type:"text/css",href:b}).appendTo("body");$(a).show();$(a).addClass("oneNoteClipperTooltipIframeLoaded")},error:function(){$(a).remove()}})});document.body.appendChild(a)},CreateIframeListener=function(d){var a=window.addEventListener?"addEventListener":"attachEvent",c=window[a],b=a=="attachEvent"?"onmessage":"message";c(b,function(a){console.log(a.origin);if(a.origin.indexOf("onenote.com")>=0||a.origin.indexOf("onenote-int.com")>=0){var b=JSON.parse(a.data);if(b.cid==d){console.log("tooltipBootstrapper.ts, parent received message!:  ",a.data);if(b.event=="tt_close")$("#"+tooltipIframeId).remove();else if(b.event=="tt_tryit"){$("#"+tooltipIframeId).remove();SendMessageToExtension({action:"clip"},function(){})}}}},false)};function Do(){SendMessageToExtension({action:"tt_process"},function(a){console.log("tooltipBootstrapper.cs: tt_process got a response of "+a.tt_process);if(a&&a.tt_process==true){CreateIframeTooltip(a.iframeSrcUrl,a.iframeCssUrl);CreateIframeListener(a.cid)}})}Do();